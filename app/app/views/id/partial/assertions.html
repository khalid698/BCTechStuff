<div ng-repeat="assertionType in identity.displayAssertionTypes()" class="assertion-row">
  <div class="assertion" ng-class="{assertionedit: identity.isEditing(assertionType)}">

    <div class="row" ng-if="!selectedIdentity.contractAddress">
      <div class="alert alert-danger" role="alert">
        Please <a href="" ui-sref="id.settings">create a contract</a> before making assertions.
      </div>
    </div>

    <!-- Assertion title -->

    <div class="row">
      <div class="col-lg-12">
        <label>{{assertionType.label}}</label>
      </div>
    </div>

    <div class="row">
      <!-- Display in read mode -->
      <div class="col-lg-10 information" ng-if="!identity.isEditing(assertionType)" ng-switch on="assertionType.format">
      <span ng-switch-when="text">{{identity.assertions[assertionType.id]}}</span>
      <span ng-switch-when="date">{{helpers.dateConverter(identity.assertions[assertionType.id]) | date: helpers.getDateFormat()}}</span>
      <span ng-switch-when="number">{{identity.assertions[assertionType.id]}}</span>
      <span ng-switch-when="multiline">{{identity.assertions[assertionType.id]}}</span>
        
        <ul class="attestees">
          <li ng-repeat="attestee in identity.attestations[assertionType.id]">
            <i class="fa fa-check-circle success" data-toggle="tooltip" title="{{ helpers.identityNameByAddress(attestee) }}"></i>
          </li>
        </ul>
      </div>

      <!-- Edit button -->
      <div class="col-xs-2 text-right" ng-if="!identity.isEditing(assertionType)">
        <a href="" class="edit" ng-click="identity.edit(assertionType)"><i class="fa fa-pencil-square-o"></i></a>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-12" ng-if="identity.isEditing(assertionType)" ng-switch on="assertionType.format">
        <div class="form-group col-xs-4">
          <input 
              class="form-control"
              ng-switch-when="text" 
              type="text" 
              ng-model="identity.assertions[assertionType.id]" 
              ng-change="identity.changed(assertionType)"/>
          <input 
              class="form-control"
              ng-switch-when="date" 
              type="date" 
              ng-model="identity.assertions[assertionType.id]" 
              ng-change="identity.changed(assertionType)"/>
          <input 
              class="form-control"
              ng-switch-when="number" 
              type="number" 
              ng-model="identity.assertions[assertionType.id]" 
              ng-change="identity.changed(assertionType)"/>
          <input 
              class="form-control"
              ng-switch-when="multiline" 
              type="text" 
              ng-model="identity.assertions[assertionType.id]" 
              ng-change="identity.changed(assertionType)"/>
          <i class="fa fa-undo" ng-click="identity.read(assertionType)" ng-if="identity.isChanged(assertionType)"></i>
        </div>
      </div>
      <div class="col-xs-12" ng-if="identity.isEditing(assertionType)">
        <button class="btn btn-primary" ng-click="identity.finishEdit(assertionType)">Update</button>
        <button class="btn btn-link" ng-click="identity.cancelEdit(assertionType)">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- Save button if pending changes -->
<div class="save row" ng-if="identity.hasChangedKeys() && !progressbar.active()">
  <div class="col-lg-4">
    <button type="button" class="btn btn-primary btn-lg btn-block" ng-click="identity.assert()">Save your changes</button>
  </div>
</div>
